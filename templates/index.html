<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

    <!-- Bulma CSS ë§í¬ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">

    <!-- font-awesome ë§í¬  -->
    <script src="https://kit.fontawesome.com/23b05056a7.js" crossorigin="anonymous"></script>

    <!-- í°íŠ¸ ë§í¬ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dokdo&display=swap" rel="stylesheet">
    <!-- í”„ë¦¬í…ë‹¤ë“œ ì ìš© -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" />
    <!--ogíƒœê·¸-->
    <meta property="og:title" content="ëŒí•˜ë¥´ë°©ì˜ í‹°íƒ€ì„"/>
    <meta property="og:description" content="ì œì£¼ë„ ì¹´í˜ ì§€ì—­ë³„ë¡œ ì°¾ì•„ë³´ê³  ì½”ë©˜íŠ¸ë¥¼ ë‹¬ì•„ì£¼ì„¸ìš”!"/>
    <meta property="og:image" content="{{ url_for('static', filename='ogimage.jpeg') }}" />

    <title>ëŒí•˜ë¥´ë°©ì˜ í‹°íƒ€ì„ | ë©”ì¸í˜ì´ì§€</title>
    <style>
        * {
            font-family: Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', sans-serif;

        }

        /*ë„¤ë¹„ê²Œì´ì…˜ ë°” ê°™ì€ ë¼ì¸ì— ìœ„ì¹˜í•˜ë„ë¡ ì„¤ì • + ë³¼ë“œì²˜ë¦¬*/
        .nav-align {
            line-height: 50px;
            font-weight: bold;
        }

        /*left,middle,rightë¡œ ë„¤ë¹„ê²Œì´ì…˜ ë°” ì™¼ìª½,ì¤‘ê°„,ì˜¤ë¥¸ìª½ ì„¤ì •*/
        .nav-left {
            float: inline-start;
        }
        .nav-middle {
            font-size: 20px;
        }

        .nav-right {
            float: inline-end;
        }

        body, html {
            height: 100%;
        }

        /* The hero image */
        /* background-size: coverë¡œ ì´ë¯¸ì§€ ì˜ë¦¬ì§€ ì•ŠëŠ” ì„ ì—ì„œ ê½‰ ì±„ì›€ */
        .hero-image {
            /*linear-gradientë¡œ ë°°ê²½ì— ë°˜íˆ¬ëª…í•œ ì»¬ëŸ¬ ë®ê¸°*/
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url("http://localguide.co.kr/wp-content/uploads/2020/07/20200110-g100-0761-1-e1597759075396-2048x732.jpeg");
            height: 50%;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            position: relative;
        }

        .hero-text {
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
        }

        .main-text {
            font-family: 'Dokdo', cursive;
            font-size: 80px;
            letter-spacing: -5px;
            margin-top: 60px;
        }


        .new-cafebox {
            display: none;
            width: 500px;
            margin: auto;
            border: 1px solid #adb3ba;
            border-radius: 10px;
            padding: 30px 40px 30px 40px;
            margin-top: 50px;
        }

        .btn_newcafe {
            width: 100px;
            display: block;
            margin: 30px auto 0px auto;
        }


        .search-margin {
            margin-top: 60px;
        }


        .cards-wrap {
            width: 1200px;
            margin: 10px auto 0px auto;
        }

        .put-icon img {
            position: relative;
        }

        .put-icon i {
            position: absolute;
            float: right;

            z-index: 1000;
        }

        .card-img-top {
            width: 100%;
            height: 15vw;
            object-fit: cover;

        }

        /*ì¹´ë“œ hoverì‹œ ì»¤ì„œ ë³€ê²½ ë° í¬ê¸° í™•ëŒ€*/
        .card {
            margin-top: 10px;
            position: relative;
            z-index: 1;
        }

        /*ì¹´ë“œ ì£¼ì†Œ ë°•ìŠ¤ í¬ê¸° ê³ ì •*/
        .card-address-align {
            height: 120px;
        }

        .like-button {
            position: absolute;
            color: black;
            right: 10px;
            z-index: 2;
            cursor: pointer;
        }

        .like-button-1 {
            position: absolute;
            color: red;
            right: 10px;
            z-index: 2;
            cursor: pointer;
        }

        .card:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .card-img-top {
            cursor: pointer;
        }

    </style>
    <script>
        <!-- ì½”ë©˜íŠ¸ ì¶”ê°€í•˜ê¸° -->
        function post() {
            // ëª¨ë‹¬ ë‚´ì—ì„œ 'í¬ìŠ¤íŒ…í•˜ê¸°' í´ë¦­ ì‹œ ëŒ“ê¸€, ì ìˆ˜, ì‘ì„±í•œ ì¹´í˜ ê°’ ê°€ì ¸ì˜¤ê¸°
            let cafe_name = $('#modal-post').attr('cafe_name');
            let score = $('#score-box').val()
            let comment = $('#comment-box').val()

            $.ajax({
                type: "POST",
                url: "/api/comment",
                data: {
                    cafe_name_give: cafe_name,
                    //jinja2 ì–¸ì–´ í™œìš©í•´ì„œ í˜„ì¬ ì ‘ì†í•œ ì‚¬ìš©ìì˜ nickname ê°€ì ¸ì˜¤ê¸°
                    //user_infoëŠ” app.py ë‚´ def home()ì— ì§€ì •ë˜ì–´ ìˆìŒ.
                    nickname_give: `{{user_info['nickname']}}`,
                    score_give: score,
                    comment_give: comment
                },
                success: function (response) {
                    alert(response["msg"])
                    window.location.reload();

                }
            });
        }

        function Add_newcafe() {
            let name = $('#New-name').val()
            let Area = $('#New-Area').val()
            let Address = $('#New-address').val()
            let Imgurl = $('#Img-url').val()

            $.ajax({
                type: "POST",
                url: "/api/create",
                data: {
                    CafeName_give: name,
                    CafeArea_give: Area,
                    CafeAddress_give: Address,
                    CafeImgurl_give : Imgurl
                },
                success: function (response) {
                    alert(response["msg"])
                    window.location.reload()
                }
            })
        }

<<<<<<< HEAD
        //ì¹´í˜ ì¹´ë“œ ì´ë¯¸ì§€ í´ë¦­ ì‹œ, ëª¨ë‹¬ì—ì„œ ì‘ì„±í•œ ì½”ë©˜íŠ¸ ë³´ì—¬ì£¼ê¸°
=======
        function searchCafe() {
            let cafe_name = $('#search-string').val()
            if (cafe_name == "")
                alert('ê²€ìƒ‰í•  ì¹´í˜ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.')
            else
                window.location = '/api/search?cafe_name=' + cafe_name
        }

>>>>>>> 2c09f9c6cbf3a23c43ae7b9e5fd50adbf747c331
        function showComments(cafe_name) {
            $.ajax({
                type: "GET",
                url: "/api/read",
                data: {"cafe_name": cafe_name},
                success: function (response) {
                    // í•¨ìˆ˜ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ë˜‘ê°™ì€ ì½”ë©˜íŠ¸ê°€ ê³„ì† ë¶™ì—¬ì§€ê¸° ë•Œë¬¸ì— í•œë²ˆ empty ì‹¤í–‰ í›„ ì§„í–‰
                    $('#saved_comments').empty()
                    // app.pyì—ì„œ ì„ íƒëœ ì¹´í˜ì˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ê¸°
                    let lists = response['all_replies']
                    // ì½”ë©˜íŠ¸ ë…¸ì¶œì— í•„ìš”í•œ nickname, score, comment ê°’ ì§€ì •í•´ì£¼ê¸°
                    for (let i = 0; i < lists.length; i++) {
                        let nickname = lists[i]['nickname']
                        let score = lists[i]['score']
                        let comment = lists[i]['comment']
                        //ë“±ë¡ëœ ì½”ë©˜íŠ¸ html ê°€ì ¸ì™€ì„œ innerTextë¶€ë¶„ ë°”ê¿”ì£¼ê¸°
                        let temp_html = `<tr>
                                            <th scope="row">${i + 1}</th>
                                            <td>${nickname}</td>
                                            <td>${score}</td>
                                            <td>${comment}</td>
                                        </tr>`
                        console.log(temp_html)
                        //temp_html ì½”ë©˜íŠ¸ ë…¸ì¶œë˜ëŠ” ë¶€ë¶„ì˜ id ì°¾ì•„, ë°‘ì— ë¶™ì—¬ë„£ì–´ì£¼ê¸°
                        $('#saved_comments').append(temp_html)
                    }
                }
            })
        }

        function openClose() {
            let status = $('#post-box').css('display');
            if (status == 'block') {
                $('#post-box').hide();
            } else {
                $('#post-box').show();
            }
        }


        function change_url(val) {
            window.location = '/api/posts/?area=' + val
        }

        function like_post(name) {
            $.ajax({
                type: "POST",
                url: "/api/like",
                data: {
                    cafe_name_give: name,
                    user_name_give: `{{user_info['username']}}`
                },
                success: function (response) {
                    alert(response["msg"])
                    window.location.reload();

                }
            });
        }

        function sign_out() {
            $.removeCookie('mytoken', {path: '/'});
            alert('ë¡œê·¸ì•„ì›ƒ!')
            window.location.href = "/"
        }


    </script>
</head>
<body>

<!--ë„¤ë¹„ê²Œì´ì…˜ ë°”-->
<nav class="navbar is-fixed-top is-white nav-align" role="navigation" aria-label="main navigation">
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ì¢Œì¸¡ ëŒí•˜ë¥´ë°© ì´ë¯¸ì§€ ìœ„ì¹˜ ì•Œë ¤ì£¼ê¸° -->
    <div class="nav-left">
            <img src="{{ url_for('static', filename='main_icon.png') }}">
    </div>
    <!-- ë¡œê·¸ì¸ ë‹‰ë„¤ì„ ë”°ë¼ ì¸ì‚¬ -->
    <div class="nav-middle">ğŸŠ í˜¼ì €ì˜µì„œì˜ˆ {{ user_info['nickname'] }}ë‹˜ ğŸŠ</div>
    <!-- ë¡œê·¸ì•„ì›ƒ -->
    <div class="nav-right"><a onclick="sign_out()">ë¡œê·¸ì•„ì›ƒ</a></div>
</nav>

<!--hero banner / ì´ë¯¸ì§€ ë„£ê¸° ìœ„í•´ classê°’ ì§€ì • -->
<div class="hero-image">
    <!-- hero banner ì•ˆì— ë“¤ì–´ê°ˆ í…ìŠ¤íŠ¸/ë²„íŠ¼ ì¶”ê°€ -->
    <div class="hero-text">
        <h1 class="main-text">ëŒí•˜ë¥´ë°©ì˜ í‹°íƒ€ì„</h1><br>
        <p>ì‹ ê·œ ì¹´í˜ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”</p><br>
        <button type="button" class="btn btn-outline-primary" onclick="openClose()">ì¹´í˜ ì¶”ê°€í•˜ê¸°</button>
    </div>

</div>


<!--ì‹ ê·œì¹´í˜ í¬ìŠ¤íŒ… ë°•ìŠ¤-->
<!--ì¹´í˜ëª…/ì´ë¯¸ì§€url/ì§€ì—­/ìƒì„¸ì£¼ì†Œ inputë°•ìŠ¤ ì‚½ì…-->
<form class="new-cafebox" id="post-box">
    <div class="form-group">
        <label>ì¹´í˜ëª…</label>
        <input type="text" class="form-control" id="New-name" aria-describedby="emailHelp" placeholder="">
    </div>
    <div class="form-group">
        <label>ì´ë¯¸ì§€url</label>
        <input type="text" class="form-control" id="Img-url" aria-describedby="emailHelp" placeholder="">
    </div>
    <div>
        <!-- select/option í™œìš©í•œ ì§€ì—­ì„ íƒ ë“œë¡­ë°•ìŠ¤ ì¶”ê°€ -->
        <label class="my-1 mr-2" for="inlineFormCustomSelectPref">ì§€ì—­</label>
        <select class="custom-select my-1 mr-sm-2" id="New-Area">
            <option selected value="">ì§€ì—­ì„ íƒ</option>
            <option value="ì œì£¼ì‹œ">ì œì£¼ì‹œ</option>
            <option value="ì„±ì‚°ì">ì œì£¼ë™ë¶€</option>
            <option value="ì„œê·€í¬ì‹œ">ì„œê·€í¬</option>
            <option value="ì• ì›”ì">ì œì£¼ì„œë¶€</option>
        </select>
    </div>
    <br>
    <div class="form-group">
        <label for="exampleInputEmail1">ì„¸ë¶€ì£¼ì†Œ</label>
        <!-- placeholderì— ìƒì„¸ì£¼ì†Œ ì‘ì„± ì˜ˆì‹œ ë„£ì–´, ì‚¬ìš©ìê°€ ìì„¸í•œ ì£¼ì†Œ ì…ë ¥í•  ìˆ˜ ìˆë„ë¡ ìœ ë„ -->
        <input type="text" class="form-control" id="New-address" aria-describedby="emailHelp"
               placeholder="ex) ì œì£¼ì‹œ ê³µí•­ë¡œ 2">
    </div>
    <button type="button" class="btn_newcafe btn btn-dark" onclick="Add_newcafe()">ì¹´í˜ì¶”ê°€</button>
</form>

<!--ì¹´ë“œë‚´ìš©-->
<!-- í˜ì´ì§€ ë‚´ ì¹´ë“œ ì •ë ¬ì„ ìœ„í•´ ì „ì²´ ì¹´ë“œ ë¬¶ì–´ì£¼ëŠ” div ìƒì„± ë° class ì§€ì • -->
<div class="cards-wrap">

    <!--í•˜ë‹¨ ë°”-->
    <nav class="level search-margin">
        <!-- Left side (ë¹ˆê³µê°„) -->
        <div class="level-left">
            <button class="button is-link is-rounded" onclick="window.location.href='/api/mycafe'">
                <span class="icon is-small">
                    <i class="fas fa-coffee"></i>
                </span>
                <span>ë‚´ê°€ ì°œí•œ ì¹´í˜ ë³´ê¸°</span>
            </button>
        </div>

        <!-- Right side -->
        <div class="level-right">
            <div class="control has-icons-left level-item">
                <div class="select is-rounded is-link" style="display: inline-block">
                    <select name="area" onchange="change_url(this.value);">
                        <option selected>ì§€ì—­</option>
                        <option value="ì§€ì—­ì „ì²´">ì „ì²´ë³´ê¸°</option>
                        <option value="ì œì£¼ì‹œ">ì œì£¼ì‹œ</option>
                        <option value="ì„±ì‚°ì">ì œì£¼ë™ë¶€</option>
                        <option value="ì„œê·€í¬ì‹œ">ì„œê·€í¬</option>
                        <option value="ì• ì›”ì">ì œì£¼ì„œë¶€</option>
                    </select>
                </div>
                <div class="icon is-small is-left">
                     <i class="fas fa-map-marker-alt"></i>
                </div>
            </div>
            <div class="level-item">
                <div class="field has-addons">
                    <p class="control">
                        <input class="input is-rounded" id="search-string" type="text" placeholder="ì¹´í˜ ì´ë¦„ ê²€ìƒ‰..">
                    </p>
                    <p class="control">
                        <button class="button is-info is-rounded" onclick="searchCafe()">
                            Search
                        </button>
                    </p>
                </div>
            </div>
        </div>

    </nav>


    <!--ì¹´ë“œ-->
    <!--ë¹ˆí•˜íŠ¸ <i class="fa fa-heart-o" aria-hidden="true"></i>-->
    <!--ìƒ‰ì¹ ëœí•˜íŠ¸<i class="fa fa-heart" aria-hidden="true"></i>-->

    <div class="card-columns">

        {# jinja2 ì¹´ë“œ ë‚´ìš© ë¶ˆëŸ¬ì˜¤ê¸° #}
        {% for cafe in cafe_lists %}

        <!--        <div class="card" onclick='$("#modal-post").addClass("is-active")'>-->
        <div class="card" id="selected-card">

            <!-- idê°’ #modal-post ì— cafe_name ì´ë¼ëŠ” ì„ì˜ì˜ ì†ì„±ê°’ì„ ê° ì¹´ë“œì— ì‹¬ì–´ë‘ê³ ,
                ì¹´ë“œë¥¼ ì„ íƒí•˜ì—¬ modal ì´ ì—´ë¦´ ë•Œ í•´ë‹¹ ì†ì„±ê°’ìœ¼ë¡œ cafe_name ì„ ê°€ì ¸ì˜¨ë‹¤. -->
            <div >
                <img class="card-img-top" src="{{ cafe.cafe_thumbnail_url }}"
                     alt="Card image cap" onclick='showComments("{{cafe.cafe_name}}"); $("#modal-post").addClass("is-active").attr("cafe_name","{{cafe.cafe_name}}");'>
                <div class="card-body card-address-align">
                    <div href="#" class="like-button" onclick="like_post('{{ cafe.cafe_name }}') ">
                        {% if cafe.cafe_name in user_info.like %}
                            <i class="fas fa-heart fa-lg like-button-1"></i>
                        {% else %}
                            <i class="far fa-heart fa-lg"></i>
                        {% endif %}
                    </div>
                    <h5 class="card-title" id="card-selected"><b>{{ cafe.cafe_name }}</b></h5>
                    <p class="card-text">{{ cafe.cafe_address }}</p>
                </div>
            </div>
        </div>
        {% endfor %}


    </div>

</div>

<!--ì¹´ë“œ í´ë¦­ ì‹œ íŒì—…ë˜ëŠ” ëª¨ë‹¬-->
<!--í´ë¦­í•œ ì¹´ë“œì— ëŒ€í•œ ê°œë³„í™”ëœ ëª¨ë‹¬ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”-->


<div class="modal" id="modal-post">
    <div class="modal-background" onclick='$("#modal-post").removeClass("is-active")'></div>
    <div class="modal-content">
        <div class="box">
            <article class="media">
                <div class="media-content">
                    <div class="field">
                        <p class="control">
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th scope="col"></th>
                                <th scope="col">ë‹‰ë„¤ì„</th>
                                <th scope="col">ì ìˆ˜</th>
                                <th scope="col">ì½”ë©˜íŠ¸</th>
                            </tr>
                            </thead>
                            <tbody id="saved_comments">
                            <tr>
                                <th scope="row">1</th>
                                <td>Mark</td>
                                <td>5</td>
                                <td>ë§›ìˆì–´ìš”!</td>
                            </tr>
                            <tr>
                                <th scope="row">2</th>
                                <td>Hodoo</td>
                                <td>3</td>
                                <td>ë§›ìˆëŠ”ë° ì§ì›ë¶„ì´ ë¶ˆì¹œì ˆí•´ì„œ 2ì  ëºì–´ìš”</td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="btn-group">
                            <select class="custom-select my-1 mr-sm-2" id="score-box">
                                <option selected>SCORE</option>
                                <option value="5">5</option>
                                <option value="4">4</option>
                                <option value="3">3</option>
                                <option value="2">2</option>
                                <option value="1">1</option>
                            </select>
                        </div>

                        <textarea id="comment-box" class="textarea" placeholder="ì½”ë©˜íŠ¸ë¥¼ ì‘ì„±í•˜ì„¸ìš”"></textarea>
                        </p>
                    </div>
                    <nav class="level is-mobile">
                        <div class="level-left">

                        </div>
                        <div class="level-right">
                            <div class="level-item">
                                <a class="button is-sparta" onclick="post()">í¬ìŠ¤íŒ…í•˜ê¸°</a>
                            </div>
                            <div class="level-item">
                                <a class="button is-sparta is-outlined"
                                   onclick='$("#modal-post").removeClass("is-active")'>ì·¨ì†Œ</a>
                            </div>
                        </div>
                    </nav>
                </div>
            </article>
        </div>
    </div>
    <button class="modal-close is-large" aria-label="close"
            onclick='$("#modal-post").removeClass("is-active")'></button>
</div>


</body>

</html>